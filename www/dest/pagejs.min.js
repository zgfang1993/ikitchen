/!*! ikitchen 31-03-2017 *!/
angular.module("starter",["ionic","starter.controllers"]).run(function(a){a.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}).config(["$ionicConfigProvider",function(a){a.platform.ios.tabs.style("standard"),a.platform.ios.tabs.position("bottom"),a.platform.android.tabs.style("standard"),a.platform.android.tabs.position("bottom"),a.platform.ios.navBar.alignTitle("center"),a.platform.android.navBar.alignTitle("center"),a.platform.ios.backButton.previousTitleText("").icon("ion-ios-arrow-thin-left"),a.platform.android.backButton.previousTitleText("").icon("ion-android-arrow-back"),a.platform.ios.views.transition("ios"),a.platform.android.views.transition("android")}]).config(function(a,b){a.state("tab",{url:"/tab",abstract:!0,templateUrl:"templates/tabs.html"}).state("tab.ikitchen",{url:"/ikitchen",views:{"tab-ikitchen":{templateUrl:"templates/tab-ikitchen.html",controller:"ikitchenCtrl"}}}).state("tab.login",{url:"/login",views:{"tab-Mine":{templateUrl:"templates/login.html",controller:"loginCtrl"}}}).state("ikitchen-popular",{url:"/ikitchen/weekly_popular",templateUrl:"templates/ikitchen-popular.html",controller:"PopulCtrl"}).state("test",{url:"/test",templateUrl:"templates/ikitchen-test.html",controller:"TestCtrl"}).state("create-name",{url:"/create/name",templateUrl:"templates/create-name.html",controller:"CreateNameCtrl"}).state("create-detail",{params:{menuName:null},url:"/create/detail",templateUrl:"templates/create-detail.html",controller:"CreateDetailCtrl"}).state("menu-classification",{url:"/menu/menu-classification",templateUrl:"templates/menu-classification.html",controller:"ClassificationCtrl"}).state("menu-search",{url:"/menu/menu-search",templateUrl:"templates/menu-search.html",controller:"SearchPageCtrl"}).state("menu-list",{params:{id:null,source:null,search_key:null},url:"/menu/menu-list",templateUrl:"templates/menu-list.html",controller:"MenuSearchCtrl"}).state("menu-detail",{params:{id:null},url:"/menu/menu-detail",templateUrl:"templates/menu-detail.html",controller:"MenuDetailCtrl"}),b.otherwise("/tab/ikitchen")}),angular.module("starter.controllers",[]).directive("autofocus",["$timeout",function(a){return{restrict:"A",link:function(b,c){a(function(){c[0].focus()})}}}]).directive("myEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.myEnter)}),b.preventDefault())})}}).filter("myLimitTo",[function(){return function(a,b){var c=Object.keys(a);if(c.length<1)return[];var d=new Object,e=0;return angular.forEach(c,function(c,f){if(e>=b)return!1;d[c]=a[c],e++}),d}}]).controller("TestCtrl",function(a,b,c){}).controller("ikitchenCtrl",function(a,b){a.toSearchPage=function(){b.go("menu-search")}}).controller("loginCtrl",function(a,b){}).controller("SearchPageCtrl",function(a,b,c,d){function e(){a.search_show=""!=a.search_val;var b={input:a.search_val};""!=a.search_val&&d({url:"http://120.24.225.232/api/search/relate/",method:"post",data:b}).success(function(b){console.log(b.content),a.keys=b.content.hot,a.my_favorite=b.content.like}).error(function(a){})}function f(a){d({url:"http://120.24.225.232/api/search/insert/",method:"POST",data:{input:a}}).success(function(a,b,c,d){console.log(a)}).error(function(a,b,c,d){}),b.go("menu-list",{source:"menu-search",search_key:a})}a.keys={},a.del_key=function(){a.search_val="",e()},a.returnpage=function(){a.search_show=!1,a.search_val="",b.go("tab.ikitchen")},d({url:"http://120.24.225.232/api/search/hot_recent/",method:"get"}).success(function(b){console.log(b.content),a.recent=b.content.recent,a.recent_show=0!=a.recent.length,a.hot=b.content.hot}).error(function(a){}),a.clearRecent=function(){d({url:"http://120.24.225.232/api/search/clear/",method:"get"}).success(function(b){a.recent_show=!1}).error(function(a){})},a.search_val="",a.search_show=!1,a.search_change=e,a.goToMenuList=f,a.mykey=function(b){13==(window.event?b.keyCode:b.which)&&f(a.search_val)}}).controller("ClassificationCtrl",function(a,b,c,d,e){d({url:"http://120.24.225.232/api/menu/all/",method:"get"}).success(function(b){a.cf_list=b.content,a.load=function(){$(".menu-panel .col-25").css("height",$(".menu-panel .col-25").css("width"))}}).error(function(a){console.log(a.detail)}),a.goMeneList=function(a,c){var d={id:a,source:"menu-classification",search_key:c};b.go("menu-list",d)}}).controller("MenuSearchCtrl",function(a,b,c,d,e,f){function g(){var b="http://120.24.225.232/api/cookbook/by_menu/?menu="+j,d="http://120.24.225.232/api/cookbook/by_name/?name="+i;c({url:j?b:d,method:"GET"}).success(function(b,c,d,e){a.menuLists=b.content,0==a.menuLists.length?a.notFund=!0:($.each(a.menuLists,function(a,b){b.do_num=parseInt(b.do_num),b.score=parseFloat(b.score),b.favorite=parseInt(b.favorite)}),console.log(a.menuLists))}).error(function(a,b,c,d){console.log("请求失败")})}console.log(e),a.sort_active={auto:"active",score:"",do_num:""};var h=e.source,i=e.search_key,j=e.id;a.search_key=i,a.menuSort=function(b){a.sort_active={auto:"",score:"",do_num:""},a.sort_active[b]="active",a.sortFlag=b},g(),a.focus_search=function(){d.go("menu-search")},b.fromTemplateUrl("templates/modal.html",{scope:a}).then(function(b){a.modal=b}),a.goBack=function(){d.go(h)},a.goDetail=function(a){var b={id:a,source:"menu-list"};d.go("menu-detail",b)}}).controller("MenuDetailCtrl",function(a,b,c,d,e){b({url:"http://120.24.225.232/api/cookbook/by_cookbook_id/",method:"POST",data:{id:c.id}}).success(function(b,c,d,e){console.log("菜谱详情"),console.log(b),a.menu=b.content}).error(function(a,b,c,d){console.log("sss")}),a.goBack=function(){e.goBack()}}).controller("CreateNameCtrl",function(a,b){a.data={menuName:""},a.createDetail=function(){console.log(a.data.menuName);var c={menuName:a.data.menuName};b.go("create-detail",c)}}).controller("CreateDetailCtrl",function(a,b){a.menuName=b.menuName,a.materials=[{material:"",amount:""}],a.steps=[{id:0,desc:"",img:""},{id:1,desc:"",img:""}],a.data={mshowDeleteReorder:!1,showDeleteReorder:!1,adj:"调整用料",adjstep:"调整步骤"},a.onItemDelete=function(b,c){a[c].splice(a[c].indexOf(c),1)},a.moveItem=function(b,c,d,e){a[e].splice(c,1),a[e].splice(d,0,b)},a.add=function(b){"materials"==b&&a[b].push({material:"",amount:""}),"steps"==b&&a[b].push({id:a.steps.length,desc:"",img:""})},a.adjust=function(b){"materials"==b&&(a.data.adj=a.data.mshowDeleteReorder?"调整用料":"调整完成",a.data.mshowDeleteReorder=!a.data.mshowDeleteReorder,a.mate=a.data.mshowDeleteReorder?{width:"40%"}:{width:"50%"}),"steps"==b&&(a.data.adjstep=a.data.showDeleteReorder?"调整步骤":"调整完成",a.data.showDeleteReorder=!a.data.showDeleteReorder,a.stepImg=a.data.showDeleteReorder?{width:"60%"}:{width:"100%"})}}).controller("PopulCtrl",function(a,b){b({url:"js/popudata.json",method:"GET"}).success(function(b,c,d,e){a.popu_data=b}).error(function(a,b,c,d){console.log("sss")})});